<h1 id="what-you-should-know-about-omnibus-packages">What you should know about omnibus packages</h1>

<p>Most users install GitLab using our omnibus packages. As a developer it can be
good to know how the omnibus packages differ from what you have on your laptop
when you are coding.</p>

<h2 id="files-are-owned-by-root-by-default">Files are owned by root by default</h2>

<p>All the files in the Rails tree (<code class="prettyprint">app/</code>, <code class="prettyprint">config/</code> etc.) are owned by &lsquo;root&rsquo; in
omnibus installations. This makes the installation simpler and it provides
extra security. The omnibus reconfigure script contains commands that give
write access to the &#39;git&rsquo; user only where needed.</p>

<p>For example, the &#39;git&rsquo; user is allowed to write in the <code class="prettyprint">log/</code> directory, in
<code class="prettyprint">public/uploads</code>, and they are allowed to rewrite the <code class="prettyprint">db/schema.rb</code> file.</p>

<p>In other cases, the reconfigure script tricks GitLab into not trying to write a
file. For instance, GitLab will generate a <code class="prettyprint">.secret</code> file if it cannot find one
and write it to the Rails root. In the omnibus packages, reconfigure writes the
<code class="prettyprint">.secret</code> file first, so that GitLab never tries to write it.</p>

<h2 id="code-data-and-logs-are-in-separate-directories">Code, data and logs are in separate directories</h2>

<p>The omnibus design separates code (read-only, under <code class="prettyprint">/opt/gitlab</code>) from data
(read/write, under <code class="prettyprint">/var/opt/gitlab</code>) and logs (read/write, under
<code class="prettyprint">/var/log/gitlab</code>). To make this happen the reconfigure script sets custom
paths where it can in GitLab config files, and where there are no path
settings, it uses symlinks.</p>

<p>For example, <code class="prettyprint">config/gitlab.yml</code> is treated as data so that file is a symlink.
The same goes for <code class="prettyprint">public/uploads</code>. The <code class="prettyprint">log/</code> directory is replaced by omnibus
with a symlink to <code class="prettyprint">/var/log/gitlab/gitlab-rails</code>.</p>
