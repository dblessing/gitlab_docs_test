<h1 id="repository-files">Repository files</h1>

<p><strong>CRUD for repository files</strong></p>

<p><strong>Create, read, update and delete repository files using this API</strong></p>

<h2 id="get-file-from-repository">Get file from repository</h2>

<p>Allows you to receive information about file in repository like name, size, content. Note that file content is Base64 encoded.</p>
<pre class="highlight plaintext"><code>GET /projects/:id/repository/files
</code></pre>

<p>Example response:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key.rb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app/models/key.rb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">1476</span><span class="p">,</span><span class="w">
  </span><span class="nt">"encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base64"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IyA9PSBTY2hlbWEgSW5mb3..."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"blob_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"79f7bbd25901e8334750839545a9bd021f0e4c83"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"commit_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d5a3ff139356ce33e37e73add446f16869741b50"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Parameters:</p>

<ul>
<li><code class="prettyprint">file_path</code> (required) - Full path to new file. Ex. lib/class.rb</li>
<li><code class="prettyprint">ref</code> (required) - The name of branch, tag or commit</li>
</ul>

<h2 id="create-new-file-in-repository">Create new file in repository</h2>
<pre class="highlight plaintext"><code>POST /projects/:id/repository/files
</code></pre>

<p>Example response:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app/project.rb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branch_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Parameters:</p>

<ul>
<li><code class="prettyprint">file_path</code> (required) - Full path to new file. Ex. lib/class.rb</li>
<li><code class="prettyprint">branch_name</code> (required) - The name of branch</li>
<li><code class="prettyprint">encoding</code> (optional) - &lsquo;text&rsquo; or &#39;base64&rsquo;. Text is default.</li>
<li><code class="prettyprint">content</code> (required) - File content</li>
<li><code class="prettyprint">commit_message</code> (required) - Commit message</li>
</ul>

<h2 id="update-existing-file-in-repository">Update existing file in repository</h2>
<pre class="highlight plaintext"><code>PUT /projects/:id/repository/files
</code></pre>

<p>Example response:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app/project.rb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branch_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Parameters:</p>

<ul>
<li><code class="prettyprint">file_path</code> (required) - Full path to file. Ex. lib/class.rb</li>
<li><code class="prettyprint">branch_name</code> (required) - The name of branch</li>
<li><code class="prettyprint">encoding</code> (optional) - &#39;text&rsquo; or &#39;base64&rsquo;. Text is default.</li>
<li><code class="prettyprint">content</code> (required) - New file content</li>
<li><code class="prettyprint">commit_message</code> (required) - Commit message</li>
</ul>

<p>If the commit fails for any reason we return a 400 error with a non-specific
error message. Possible causes for a failed commit include:
- the <code class="prettyprint">file_path</code> contained <code class="prettyprint">/../</code> (attempted directory traversal);
- the new file contents were identical to the current file contents, i.e. the
  user tried to make an empty commit;
- the branch was updated by a Git push while the file edit was in progress.</p>

<p>Currently gitlab-shell has a boolean return code, preventing GitLab from specifying the error.</p>

<h2 id="delete-existing-file-in-repository">Delete existing file in repository</h2>
<pre class="highlight plaintext"><code>DELETE /projects/:id/repository/files
</code></pre>

<p>Example response:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app/project.rb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branch_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"master"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Parameters:</p>

<ul>
<li><code class="prettyprint">file_path</code> (required) - Full path to file. Ex. lib/class.rb</li>
<li><code class="prettyprint">branch_name</code> (required) - The name of branch</li>
<li><code class="prettyprint">commit_message</code> (required) - Commit message</li>
</ul>
